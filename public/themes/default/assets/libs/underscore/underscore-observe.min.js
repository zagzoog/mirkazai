"use strict";(function(e){"object"==typeof module&&"object"==typeof module.exports?module.exports=function(t){e(t)}:e(_)})(function(e){function t(t){function n(){r(),h=JSON.parse(JSON.stringify(t))}function r(){e.each(p.generic,function(e){e(t,h)})}function i(t,n){e.each(p.create,function(e){e(t,n)})}function o(t,n,r){e.each(p.update,function(e){e(t,n,r)})}function c(t,n){e.each(p.delete,function(e){e(t,n)})}function s(){var r=h.length,u=t.length;if(r!==u||JSON.stringify(h)!==JSON.stringify(t)){for(var s=Math.max(u,r)-1,a=s;a>=0;a--){var f=h[a],p=t[a];a>r-1?i(p,a):a>u-1?c(f,a):e.isEqual(p,f)||o(p,f,a)}n()}}function a(e,n){u?Object.defineProperty(t,e,{value:n}):t[e]=n}var f=!0,h=[],p={generic:[],create:[],update:[],delete:[]};return a("pop",function(){s();var e=Array.prototype.pop.apply(this,arguments),t=this.length;return c(e,t),n(),e}),a("push",function(){s();var e=arguments[0],t=Array.prototype.push.apply(this,arguments);return i(e,t-1),n(),t}),a("reverse",function(){s();for(var t=this.length-1;t>=0;t--)c(this[t],t);var r=Array.prototype.reverse.apply(this,arguments);return e.each(this,i),n(),r}),a("shift",function(){s();var e=Array.prototype.shift.apply(this,arguments);return c(e,0),n(),e}),a("sort",function(){s();for(var t=this.length-1;t>=0;t--)c(this[t],t);var r=Array.prototype.sort.apply(this,arguments);return e.each(this,i),n(),r}),a("splice",function(t){s();for(var r=Array.prototype.slice.call(arguments,2),o=Array.prototype.splice.apply(this,arguments),u=o.length-1;u>=0;u--)c(o[u],t+u);return e.each(r,function(e,n){i(e,t+n)}),n(),o}),a("unshift",function(){s();var t=Array.prototype.unshift.apply(this,arguments);return e.each(arguments,function(e,t){i(e,t)}),n(),t}),{detectChanges:s,unbind:function(t,n){e.isUndefined(t)&&e.isUndefined(n)?e.each(p,function(e){e.length=0}):e.isString(t)&&e.isUndefined(n)?p[t].length=0:e.isFunction(t)&&e.isUndefined(n)?(n=t,t="generic",p[t]=e.without(p[t],n)):e.isString(t)&&e.isFunction(n)&&(p[t]=e.without(p[t],n))},bind:function(n,r){p[n].push(r),"generic"===n?r(t,h):"create"===n&&e.each(t,function(e,t){r(e,t)}),f&&(h=JSON.parse(JSON.stringify(t)),f=!1)}}}function n(){c.length?(e.each(c,function(e){e.detectChanges()}),r()):i=null}function r(){i&&clearTimeout(i),i=setTimeout(n,250)}var i,o=[],c=[],u=!!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions);e.mixin({observe:function(n,i,u){if(!e.isArray(n))throw"subject should be a array";e.isFunction(i)&&(u=i,i="generic");var s=e.indexOf(o,n);if(-1===s){s=o.length,o.push(n);var a=new t(n);c.push(a)}return c[s].bind(i,u),r(),n},unobserve:function(t,n,r){if(!arguments.length)return e.each(c,function(e){e.unbind()}),o.length=0,void(c.length=0);if(!e.isArray(t))throw"subject should be a array";var i=e.indexOf(o,t);return-1!==i?(c[i].unbind(n,r),t):void 0}})});